# 实验结果：固定追捕者数量扫描（`v_p/v_e × w_align`）

## 1. 实验目的

在固定追捕者数量 `N_p` 的条件下，扫描追捕者速度比 `v_p/v_e` 与逃跑者从众/对齐强度 `w_align`，观察任务性能指标（进入安全区比例、被捕比例）与群体有序性指标（极化度 `P`）随参数变化的趋势，并提取可复现的初步结论。

## 2. 产物与可复现信息

本文档包含多组逐步扩展的实验（A/B/C/D）。原始扫描结果保存在 `runs/` 下（默认不纳入版本控制），聚合结果与图表保存在 `doc/` 下（纳入版本控制）。

### 实验 A（试跑）

- 原始扫描目录：`runs/sweep_20260205_135921_grid`
  - `runs/sweep_20260205_135921_grid/base_config.json`
  - `runs/sweep_20260205_135921_grid/results.csv`
- 聚合与图表目录：`doc/results_20260205_fixedNp_scan`
  - `doc/results_20260205_fixedNp_scan/group_summary.csv`
  - `doc/results_20260205_fixedNp_scan/figs`

### 实验 B（扩展网格，包含临界性代理指标 χ）

- 原始扫描目录：`runs/sweep_20260205_154643_grid`
  - `runs/sweep_20260205_154643_grid/base_config.json`
  - `runs/sweep_20260205_154643_grid/results.csv`
- 聚合与图表目录：`doc/results_20260205_fixedNp_scan_expanded`
  - `doc/results_20260205_fixedNp_scan_expanded/group_summary.csv`
  - `doc/results_20260205_fixedNp_scan_expanded/figs`
  - `doc/results_20260205_fixedNp_scan_expanded/report.md`（自动生成的汇总报告）
 - 复现实验命令（示例，需在项目根目录执行）：
   - `uv run chasecrit sweep-grid --speed-ratio 1.0 1.05 1.1 1.15 1.2 --w-align 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1.0 --seeds 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 --steps 600 --no-save-events --no-save-timeseries`

### 实验 C（高重复数：seeds=50，新增指标 χ_local 与 ξ）

- 原始扫描目录：`runs/sweep_20260205_180558_grid`
  - `runs/sweep_20260205_180558_grid/base_config.json`
  - `runs/sweep_20260205_180558_grid/results.csv`
- 聚合与图表目录：`doc/results_20260205_fixedNp_scan_50seeds_v2`
  - `doc/results_20260205_fixedNp_scan_50seeds_v2/group_summary.csv`
  - `doc/results_20260205_fixedNp_scan_50seeds_v2/figs`
  - `doc/results_20260205_fixedNp_scan_50seeds_v2/report.md`
- 复现实验命令（示例）：
  - `uv run chasecrit sweep-grid --speed-ratio 1.0 1.05 1.1 1.15 1.2 --w-align 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1.0 --seeds 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 --steps 600 --no-save-events --no-save-timeseries --jobs 8`

### 实验 D（更高重复数：seeds=100，`speed_ratio∈{1.1,1.2}`，新增 τ 指标）

- 原始扫描目录：`runs/sweep_20260206_132212_grid`
  - `runs/sweep_20260206_132212_grid/base_config.json`
  - `runs/sweep_20260206_132212_grid/results.csv`
- 聚合与图表目录：`doc/results_20260206_fixedNp_sr11_sr12_100seeds`
  - `doc/results_20260206_fixedNp_sr11_sr12_100seeds/group_summary.csv`
  - `doc/results_20260206_fixedNp_sr11_sr12_100seeds/figs`
  - `doc/results_20260206_fixedNp_sr11_sr12_100seeds/report.md`
- 复现实验命令（示例）：
  - `uv run chasecrit sweep-grid --speed-ratio 1.1 1.2 --w-align 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1.0 --seeds 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 --steps 600 --no-save-events --no-save-timeseries --jobs 8`

## 3. 实验设置（摘要）

### 3.1 固定项（来自 base config）

- 场景：2D 连续空间；边界 `periodic`；无障碍
- 逃跑者：`N_e=128`，速度上限 `v_e=1.0`；局部观测（邻居/追捕者/安全区）
- 安全区：最大有效数量 `K_active_max=4`；缓慢移动（G0）；局部可见；容量未知；容量耗尽失效即消失；随机刷新并保持不会长期无安全区
- 追捕者：数量固定 `N_p=2`，策略 `p0_nearest`；瞬时捕获半径 `r_cap=1.0`
- 时长：每个 episode 的 `steps` 可能在不同实验中被覆盖；以各 sweep 目录下的 `base_config.json` 为准

### 3.2 变量项（实验 A：扫描网格）

- `v_p/v_e ∈ {1.0, 1.1, 1.2}`
- `w_align ∈ {0.0, 0.1, ..., 1.0}`（步长 0.1）
- 随机种子：`seed ∈ {0,1,...,9}`（每个格点 10 次重复）
- 总 episode 数：`3 × 11 × 10 = 330`

### 3.3 指标

- `safe_frac`：进入安全区人数占比（`S_safe / N_e`）
- `captured_frac`：被捕人数占比（`S_captured / N_e`）
- `P_mean`：极化度 `P(t)` 的时间均值（episode 内）
- `χ`：临界性代理指标（susceptibility proxy），定义为 `χ = N_e · Var_t(P(t))`（episode 内按时间的方差；用于定位高涨落区）
- `χ_local`：局部临界性代理指标，定义为 `χ_local = N_e · Var(P_local)`；其中 `P_local(i)=|Σ_{j∈N_i} v̂_j|/|N_i|`（邻域内局部极化度）
- `ξ`（`xi_fluct`）：空间相关长度的轻量代理（由速度方向涨落相关随距离的衰减长度估计得到）
- `τ`（`tau_P_ar1`）：相关时间的轻量代理；将 `P(t)` 视为 AR(1) 过程，用 lag-1 自相关 `ρ1` 估计积分相关时间 `τ=(1+ρ1)/(1-ρ1)`（用于对照“临界附近相关时间变长”的常见特征）

聚合方式：对每个 `(v_p/v_e, w_align)`，对 seeds 取均值并给出 95% 置信区间（正态近似 `±1.96·SEM`）。

## 4. 结果与图表

本节以实验 D（seeds=100，`speed_ratio∈{1.1,1.2}`）为主，实验 A/B/C 图表用于对照与历史记录。

### 4.1 `safe_frac` 随 `w_align` 的变化（实验 D）

![safe_vs_w_align](results_20260206_fixedNp_sr11_sr12_100seeds/figs/safe_vs_w_align.png)

### 4.2 `captured_frac` 随 `w_align` 的变化（实验 D）

![captured_vs_w_align](results_20260206_fixedNp_sr11_sr12_100seeds/figs/captured_vs_w_align.png)

### 4.3 有序性（`P_mean`）随 `w_align` 的变化（实验 D）

![P_mean_vs_w_align](results_20260206_fixedNp_sr11_sr12_100seeds/figs/P_mean_vs_w_align.png)

### 4.4 临界性/相关性代理指标（`χ`、`χ_local`、`τ`）随 `w_align` 的变化（实验 D）

![chi_vs_w_align](results_20260206_fixedNp_sr11_sr12_100seeds/figs/chi_vs_w_align.png)

![chi_local_vs_w_align](results_20260206_fixedNp_sr11_sr12_100seeds/figs/chi_local_vs_w_align.png)

![tau_P_ar1_vs_w_align](results_20260206_fixedNp_sr11_sr12_100seeds/figs/tau_P_ar1_vs_w_align.png)

### 4.5 热力图（实验 D）

![heatmap_safe_mean](results_20260206_fixedNp_sr11_sr12_100seeds/figs/heatmap_safe_mean.png)

![heatmap_chi_mean](results_20260206_fixedNp_sr11_sr12_100seeds/figs/heatmap_chi_mean.png)

### 4.6 `safe_frac` 与临界性/结构性代理（`χ`、`χ_local`、`ξ`、`τ`）的关系（实验 D，按格点聚合均值）

![scatter_safe_vs_chi](results_20260206_fixedNp_sr11_sr12_100seeds/figs/scatter_safe_vs_chi.png)

![scatter_safe_vs_chi_local](results_20260206_fixedNp_sr11_sr12_100seeds/figs/scatter_safe_vs_chi_local.png)

![scatter_safe_vs_xi](results_20260206_fixedNp_sr11_sr12_100seeds/figs/scatter_safe_vs_xi.png)

![scatter_safe_vs_tau_P_ar1](results_20260206_fixedNp_sr11_sr12_100seeds/figs/scatter_safe_vs_tau_P_ar1.png)

## 5. 初步结论（阶段性）

在实验 D（seeds=100，`speed_ratio∈{1.1,1.2}`）的条件下：

1. `safe_frac` 的最优区域依然出现在 **中等 `w_align`**：`speed_ratio=1.1` 时最优约 `w_align=0.70`；`speed_ratio=1.2` 时最优约 `w_align=0.40`。
2. 多个“临界性/相关性代理指标”的峰值点与任务最优点并不一致：`χ` 与 `τ` 的峰值点相对更接近任务最优，但 `χ_local` 与 `ξ` 的峰值点与任务最优差距更大。以本轮定义而言，“把代理指标推到最大”并不能稳定带来更高 `safe_frac`。
3. 现阶段结果更支持“任务最优来自一致性与多样性/探索的权衡”，而非“单一临界性代理指标最大化即可带来最优逃脱”。后续需要更严格的临界性证据链（有限尺寸分析、相关长度与相关时间一致指向、事件级联统计等）与更贴近临界优势假说的任务机制来检验收益。

> 详细聚合数值与各格点 95% CI 见：`doc/results_20260206_fixedNp_sr11_sr12_100seeds/group_summary.csv`。自动汇总报告见：`doc/results_20260206_fixedNp_sr11_sr12_100seeds/report.md`。

为更直接对照“更接近临界（代理指标更大）是否带来更好逃脱”，下表给出每个 `v_p/v_e` 下任务最优点，以及各代理指标峰值点对应的 `safe_frac`（均为格点聚合均值）：

| `v_p/v_e` | `w_safe` | `safe(w_safe)` | `w_χ` | `safe(w_χ)` | `w_χ_local` | `safe(w_χ_local)` | `w_τ` | `safe(w_τ)` | `w_ξ` | `safe(w_ξ)` |
|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 1.10 | 0.70 | 0.3725 | 0.20 | 0.3348 | 0.00 | 0.3315 | 0.45 | 0.3512 | 0.95 | 0.3443 |
| 1.20 | 0.40 | 0.3416 | 0.45 | 0.3374 | 0.00 | 0.3055 | 0.50 | 0.3264 | 0.85 | 0.3074 |

## 6. 下一步建议（用于收敛结论）

- 扩展追捕强度网格：增加 `v_p/v_e` 取值密度，并保持 `N_p` 固定，用于定位性能峰是否随强度平移。
- 稳健性：切换边界为 `reflecting`，并加入少量障碍，重复扫描以验证结论是否依赖于周期边界与无障碍几何。
- 追捕策略增强：在保持 `N_p` 固定的前提下，引入 `p1_intercept`，测试“中等 `w_align` 最优”是否在更强追捕下依然成立。

## 7. 实验 A 图表（历史对照）

![safe_vs_w_align_A](results_20260205_fixedNp_scan/figs/safe_vs_w_align.png)

![captured_vs_w_align_A](results_20260205_fixedNp_scan/figs/captured_vs_w_align.png)

![P_mean_vs_w_align_A](results_20260205_fixedNp_scan/figs/P_mean_vs_w_align.png)

![heatmap_safe_mean_A](results_20260205_fixedNp_scan/figs/heatmap_safe_mean.png)
