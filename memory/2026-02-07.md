# 2026-02-07 Daily Log

## SOC implementation and compatibility

- Added optional SOC controller fields to `EvaderConfig` in `src/chasecrit/config.py`.
- Added `EvaderSocState` and SOC branch in `src/chasecrit/policies.py`.
- Integrated SOC state lifecycle and SOC summary metrics in `src/chasecrit/sim.py`.
- Added SOC config templates:
  - `configs/soc_mvp.toml`
  - `configs/soc_mvp_soft.toml`

SOC is opt-in only (`soc_enabled=false` by default), preserving old behavior when disabled.

## Tests first, then implementation validation

- Added tests: `tests/test_soc_mode.py`
  - disabled SOC path is bitwise-identical for `evader_step`;
  - enabled SOC updates state and triggers toppling in low-threshold setup;
  - changing SOC parameters does not affect outputs when SOC is disabled.
- Validation:
  - `uv run pytest -q` -> `9 passed, 3 skipped`
  - `uv run pyright` -> `0 errors`

## Smoke experiments (SOC on/off comparison)

### Single-point comparison (`w_align=0.6`)

- baseline sweep:
  - `runs/sweep_20260207_103146_grid`
- SOC-MVP sweep:
  - `runs/sweep_20260207_103200_grid`
- setup:
  - `speed_ratio=1.1`, `steps=400`, `seeds=0..19`

Result snapshot:

- baseline: `safe_frac mean ≈ 0.2457`
- SOC-MVP: `safe_frac mean ≈ 0.2016`
- SOC-MVP shows persistent toppling:
  - `soc_topple_steps mean ≈ 387.5/400`
  - `soc_branch_ratio mean ≈ 1.107`

### Small grid comparison (`w_align in {0.4,0.6,0.8}`)

- baseline:
  - `runs/sweep_20260207_103331_grid`
  - report: `doc/results_20260207_soc_smoke_baseline/`
- SOC-MVP:
  - `runs/sweep_20260207_103347_grid`
  - report: `doc/results_20260207_soc_smoke_mvp/`
- SOC-Soft:
  - `runs/sweep_20260207_103434_grid`
  - report: `doc/results_20260207_soc_smoke_soft/`

Observed `safe_mean`:

- baseline: `0.2699 / 0.2457 / 0.2848` (`w=0.4/0.6/0.8`)
- SOC-MVP: `0.2395 / 0.2016 / 0.1383`
- SOC-Soft: `0.2465 / 0.1410 / 0.0992`

Interpretation:

- SOC mechanism signal exists (high toppling activity, branch ratio near 1+).
- Current SOC parameterizations do not yet improve pursuit-evasion performance.
- Likely regime is over-active (close to supercritical under this task pressure).

## Reader-facing report added

- `doc/实验结果-SOC算法接入与初步冒烟实验-20260207.md`

This report records implementation details, compatibility checks, smoke setup, quantitative results, and next-step scans.

## Clarification update

- Clarified in the SOC report that `w_align` under SOC-on is a set-point for per-agent dynamic alignment share `lambda_i(t)`, not a fixed per-step weight.
- Added explicit explanation section to avoid ambiguity between baseline fixed weight and SOC adaptive weight semantics.

## SOC-v2 design note

- Added a dedicated design document:
  - `doc/SOC-v2方案-基于预测熵波动的自组织临界控制.md`
- Core change in thought:
  - remove set-point regression to fixed `w_align` in SOC mode;
  - define dynamic alignment by stress mapping `lambda_i=f(s_i)` instead;
  - use predictive entropy fluctuation (`u_i`) as local driving term consistent with the cited paper’s `Var(H_pred)` idea.
- Document includes:
  - formal update equations,
  - SOC validity criteria before task-benefit claims,
  - staged experiment protocol for mechanism-first then performance.
